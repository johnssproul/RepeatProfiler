uniqsub<-read.table("Jockey-3_ISO1_uniqSubs")
uniqsub<-read.table("Jockey-3_ISO1_uniqSubs.txt")
NROW(annotation_file
NROW(annotation_file)
NROW("test")
colors\
colors
rainbow
rainbow(1:2)
rainbow(1:4)
rainbow(5)
rainbow(3333333333)
rainbow(333)
plot(seq(333))
plot(seq(333),col=rainbow(333))
plot(seq(400),col=rainbow(400))
plot(seq(500),col=rainbow(500))
plot(seq(1000),col=rainbow(1000))
plot(seq(1000),col=col(1000))
colors(4)
plot(seq(1000),col=colors(1000))
install.packages(viridis)
install.packages("viridis")
plot(seq(1000),col=colors(1000))
plot(seq(1000),col=viridis(1000))
viridis
scale_colour_viridis_d(3)
viridis()
library(viridis)
viridis(3)
plot(seq(1000),col=viridis(1000))
plot(seq(10000),col=viridis(10000))
plot(seq(10),col=viridis(10))
t<-c(4,4,4,4,4)
plot(hist(log(t)))
t<-c(4,4,4,5,4)
plot(hist(log(t)))
plot(hist(log(t)),xlab = "sequence length on log scale",title="Log scale of lengths of sequences in D.mel assembly")
plot(hist(log(t)),xlab = "sequence length on log scale",main="Log scale of lengths of sequences in D.mel assembly")
plot(hist(log(t)),xlab = "sequence length on log scale",main="Log scale of lengths of sequences in D.mel assembly")
plot(hist(log(t)),xlab = "sequence length on log scale",main="Log scale of lengths of sequences in D.mel assembly")
save("sequences_lengths.pdf")
theplot<-plot(hist(log(t)),xlab = "sequence length on log scale",main="Log scale of lengths of sequences in D.mel assembly")
save(theplot,"sequences_lengths.pdf")
save("sequences_lengths.pdf",theplot)
pdf("sequences_lengths.pdf",theplot)
colors <- c('#440154FF', '#3B528BFF', '#21908CFF', '#5DC863FF', '#FDE725FF', '#FDE725FF')
plot(seq(6),col=colors)
seq(6)
plot(seq(6),col=colors)
plot(seq(6),col=colors)
plot(seq(6),col=colors)
plot(seq(6),col=colors)
plot(seq(6),col=colors)
plot(seq(6))
plot(seq(6))
plot(seq(6),col=colors)
plot(seq(6),col=colors)
plot(seq(6))
plot(seq(6))
library(viridis)
plot(seq(6),col=colors)
plot(seq(1000))
colorsa <- c('#440154FF', '#3B528BFF', '#21908CFF', '#5DC863FF', '#FDE725FF', '#FDE725FF') #sets color scheme for gradient
plot(seq(4))
plot(seq(6),col=colors)
plot(seq(9),col=colors)
plot(seq(1000),col=colors)
plot(seq(1000),col=colorsa)
scale_fill_gradientn
library(viridis)
scale_fill_gradientn
library(ggplot2)
scale_fill_gradientn
multmerge <- function(mypath){
filenames <- list.files(path = mypath, full.names = TRUE)
datalist <- lapply(filenames, function(x){read.csv(file = x, header = T, check.names = FALSE)})
Reduce(function(x, y) {merge(x, y, all = TRUE)}, datalist)
}
multmerge('indel_info_allrefs')
multmerge('indel_info_allrefs')
multmerge('indel_info_allrefs')
all_indel_info<-multmerge('indel_info_allrefs')
indel_info<-multmerge('indel_info_allrefs')
indel_info[indel_info$ref=="a7a"]
indel_info$indels<-(as.numeric(indel_info$insertion)+as.numeric(indel_info$deletetion))/as.numeric(indel_info$depth)
indel_info$indels<-(as.numeric(indel_info$insertion)+as.numeric(indel_info$deletetion))/as.numeric(indel_info$depth)
indel_info$indels<-(as.numeric(indel_info$insertion)+as.numeric(indel_info$deletetion))/as.numeric(indel_info$depth)
indel_info$indels<-(as.numeric(indel_info$insertion)+as.numeric(indel_info$deletetion))/as.numeric(indel_info$depth)
indel_info$indels<-(as.numeric(indel_info$insertion)+as.numeric(indel_info$deletetion))/as.numeric(indel_info$depth)
indel_info$indels<-(as.numeric(indel_info$insertion)+as.numeric(indel_info$deletetion))/as.numeric(indel_info$depth)
indel_info
indel_info[indel_info$ref=="4"]
indel_info[indel_info$ref=="4",]
indel_info[indel_info$ref=="4",]$ref=="r"
r<-indel_info[indel_info$ref=="4",]
r[r$ref=="r",]
indel_info_ins<-indel_info[(indel_info$insertion/indel_info$depth)>0.1,]
indel_info_del<-indel_info[(indel_info$deletetion/indel_info$depth)>0.1,]
indel_info_both<-indel_info[indel_info$indel_frac>0.1,]
rep("not_good",NROW(indel_info))
indel_info[(indel_info$insertion/indel_info$depth)>0.1,]$color<- "gray"
indel_info[(indel_info$deletetion/indel_info$depth)>0.1,]color<-"black"
indel_info_both<-indel_info[indel_info$indel_frac>0.1,]$color<-"blue"
View(indel_info)
indel_info$color<-rep("not_good",NROW(indel_info))
indel_info[(indel_info$insertion/indel_info$depth)>0.1,]$color<- "gray"
indel_info[(indel_info$deletetion/indel_info$depth)>0.1,]color<-"black"
indel_info_both<-indel_info[indel_info$indel_frac>0.1,]$color<-"blue"
indel_info[(indel_info$deletetion/indel_info$depth)>0.1,]
indel_info[(indel_info$deletetion/indel_info$depth)>0.1,]
indel_info[(indel_info$deletetion/indel_info$depth)>0.1,]$color
indel_info[(indel_info$insertion/indel_info$depth)>0.1,]$color<- "gray"
indel_info[(indel_info$deletetion/indel_info$depth)>0.1,]$color<-"black"
indel_info_both<-indel_info[indel_info$indel_frac>0.1,]$color<-"blue"
indel_info_both<-indel_info[indel_info$indel_frac>0.1,]$color
indel_info<-multmerge('indel_info_allrefs')
indel_info$indels<-(as.numeric(indel_info$insertion)+as.numeric(indel_info$deletetion))
indel_info$indel_frac<-indel_info$indels/as.numeric(indel_info$depth)
indel_info$color<-rep("not_good",NROW(indel_info))
#indel_info<-indel_info[indel_info$indel_frac>0.1,]
indel_info[(indel_info$insertion/indel_info$depth)>0.1,]$color<- "gray"
indel_info[(indel_info$deletetion/indel_info$depth)>0.1,]$color<-"black"
iindel_info[indel_info$indel_frac>0.1,]$color<-"blue"
indel_info<-multmerge('indel_info_allrefs')
indel_info$indels<-(as.numeric(indel_info$insertion)+as.numeric(indel_info$deletetion))
indel_info$indel_frac<-indel_info$indels/as.numeric(indel_info$depth)
indel_info$color<-rep("not_good",NROW(indel_info))
#indel_info<-indel_info[indel_info$indel_frac>0.1,]
indel_info[(indel_info$insertion/indel_info$depth)>0.1,]$color<- "gray"
indel_info[(indel_info$deletetion/indel_info$depth)>0.1,]$color<-"black"
indel_info[indel_info$indel_frac>0.1,]$color<-"blue"
indel_info
indel_info<-indel_info[indel_info$color!="not_good"]
indel_info<-indel_info[indel_info$color!="not_good",]
indel_info
View(indel_info)
indel_info[(indel_info$deletetion/indel_info$depth)>0.1 && (indel_info$insertion/indel_info$depth)>0.1 ,]$color<-"blue"
indel_info<-multmerge('indel_info_allrefs')
indel_info$indels<-(as.numeric(indel_info$insertion)+as.numeric(indel_info$deletetion))
indel_info$indel_frac<-indel_info$indels/as.numeric(indel_info$depth)
indel_info$color<-rep("not_good",NROW(indel_info))
#indel_info<-indel_info[indel_info$indel_frac>0.1,]
indel_info[(indel_info$insertion/indel_info$depth)>0.1,]$color<- "gray"
indel_info[(indel_info$deletetion/indel_info$depth)>0.1,]$color<-"black"
indel_info[(indel_info$deletetion/indel_info$depth)>0.1 && (indel_info$insertion/indel_info$depth)>0.1 ,]$color<-"blue"
indel_info[(indel_info$deletetion/indel_info$depth)>0.1 && (indel_info$insertion/indel_info$depth)>0.1 ,]$color
indel_info<-multmerge('indel_info_allrefs')
indel_info$indels<-(as.numeric(indel_info$insertion)+as.numeric(indel_info$deletetion))
indel_info$indel_frac<-indel_info$indels/as.numeric(indel_info$depth)
indel_info$color<-rep("not_good",NROW(indel_info))
#indel_info<-indel_info[indel_info$indel_frac>0.1,]
indel_info[(indel_info$insertion/indel_info$depth)>0.1,]$color<- "gray"
indel_info[(indel_info$deletetion/indel_info$depth)>0.1,]$color<-"black"
indel_info[(indel_info$deletetion/indel_info$depth)>0.1 && (indel_info$insertion/indel_info$depth)>0.1 ,]
indel_info[(indel_info$deletetion/indel_info$depth)>0.01 && (indel_info$insertion/indel_info$depth)>0.01 ,]
indel_info[(indel_info$deletetion/indel_info$depth)>0.01 && (indel_info$insertion/indel_info$depth)>0.01 ,]
indel_info[(indel_info$deletetion/indel_info$depth)>0.01 && (indel_info$insertion/indel_info$depth)>0.01 ,]$color
indel_info[(indel_info$deletetion/indel_info$depth)>0.01 && (indel_info$insertion/indel_info$depth)>0.01 ,]$color<-"blue"
View(indel_info)
NROW(indel_info[(indel_info$deletetion/indel_info$depth)>0.1 && (indel_info$insertion/indel_info$depth)>0.1 ,])
NROW(indel_info[(indel_info$insertion/indel_info$depth)>0.1,])
NROW(indel_info[(indel_info$deletetion/indel_info$depth)>0.1,])
NROW(A7A)
colors
colours()
colours() == "black"
colours() == "dark black"
colours()
intersect(c(3,4),c(3,4))
intersect(c(3,4,5),c(3,4,6),c(3,4)
intersect(c(3,4,5),c(3,4,6),c(3,4))
Reduce(intersect,c(c(3,4,5),c(3,4,6),c(3,4)))
Reduce(intersect,list(c(3,4,5),c(3,4,6),c(3,4)))
as.numeric("a7a")
is.na(as.numeric("a7a"))
as.numeric("a7a")
numeric(a7a)
numeric("a7a")
as.numeric("a7a")
if(is.na(indel_cutoff))
indel_cutoff<-numeric("a7a")
indel_cutoff<-as.numeric("a7a")
View(all_indel_info)
all_indel_info[1,2]<-0
all_indel_info[1,3]<-0
all_indel_info[1,1]<-1
indel_info[(indel_info$insertion/indel_info$depth)>indel_cutoff,]
indel_info$insertion/indel_info$depth
indel_cutoff
indel_info$insertion
indel_info$depth
indel_info$depth[1]<-0
indel_cutoff<-0.1
NROW(indel_info[(indel_info$deletetion/indel_info$depth)>indel_cutoff,])
indel_info[indel_info$deletetion/indel_info$depth,]
indel_info[(indel_info$deletetion/indel_info$depth)>indel_cutoff,]$color<-"black"
scale_value
